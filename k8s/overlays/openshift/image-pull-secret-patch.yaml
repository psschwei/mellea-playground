# Patch to add imagePullSecrets to deployments
# Apply this when using images from private registries
#
# Prerequisites:
#   1. Create the registry-credentials secret first:
#      kubectl create secret docker-registry registry-credentials \
#        --namespace=mellea-system \
#        --docker-server=quay.io \
#        --docker-username=<username> \
#        --docker-password=<password>
#
#   2. Uncomment the reference in kustomization.yaml
#
---
# Backend deployment patch
apiVersion: apps/v1
kind: Deployment
metadata:
  name: mellea-api
  namespace: mellea-system
spec:
  template:
    spec:
      imagePullSecrets:
        - name: registry-credentials
---
# Frontend deployment patch
apiVersion: apps/v1
kind: Deployment
metadata:
  name: mellea-frontend
  namespace: mellea-system
spec:
  template:
    spec:
      imagePullSecrets:
        - name: registry-credentials
---
# Redis deployment patch
apiVersion: apps/v1
kind: Deployment
metadata:
  name: redis
  namespace: mellea-system
spec:
  template:
    spec:
      imagePullSecrets:
        - name: registry-credentials
